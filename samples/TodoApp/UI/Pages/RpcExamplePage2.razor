@page "/rpc-example2"
@inject IJSRuntime JS
@implements IAsyncDisposable

<div id="rpc-example-react-root"></div>

@code {
    private bool _isMounted;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender) {
            await JS.InvokeVoidAsync("RpcExampleReactApp.mount", "rpc-example-react-root");
            _isMounted = true;
        }
    }

    public async ValueTask DisposeAsync()
    {
        if (_isMounted) {
            try {
                await JS.InvokeVoidAsync("RpcExampleReactApp.unmount");
            }
            catch (JSDisconnectedException) {
                // Circuit is already gone
            }
            _isMounted = false;
        }
    }
}
